# Literato - Sistema de Leitura Gamificado

[itch.io](https://mufh.itch.io/literato)

[Visualizar Diagrama UML Completo](https://mermaid.live/edit#pako:eNq9Wt1u2zgWfhXBxQDObGKkadIkRlHAtb07Bhzbmzh7sQiwoCXGJUYSPaQUZNppXmYvBjPAXi32CfJieyhSEkWRtDqbbS5a2fx4yPP_I3_uhTTCvWEvjBHnE4K2DCV3aQB_330XHB0dBePR1WgyCq6Wk-k86E9o8vyvlNADsSZxKUow36EQBwmQioPP8mvxVxANbnmOGKH6gvg7ImkWkMj48iZjJN0GKU2wfYXj9COyUNrRNKPcssAzhtGPdmJ5nJEEzTHJcobskA2h9oV7mhkrf9ribBb1DwI4tr2yAJZgTe5uL6-K-7s23xRM2FcRCISp7YLhn7LowMCQNGQ4wWmGWEnJQDC8JSApxJQw-nMaoniCMhxEKEMa_Mtdamp4HOcb_EL6jTAPGQlRZ6mXKyHa2ewioimdmbfYUBpjlAa7fBOT8MXUSPhKEgSAOqJNYFJcyCRvkeqcPLCv85oMVBc7xIPyjDJjKaJwXQzKyNAVjojDAwjfpDaHQ1uSIt5mcF3cwmPqI3EVnytIyh1ENMtwMuUZSrOO5ie-zGU8mtnWYiHz2QuJV5PSGkQcu5fnJDIlCYRRlnPljhDFxCeX064Y3TLMOe1rRE0XD2kaxjlhLd8v4osgX-hEO9VvnupmptxnoIwtZm3Zlwsu-StJFipY20S9V2AygEC4skb0yq_VRdqrt-XNfKB5fb_9Nlzc0xVKJvVNLZQsIl9hdk_iyXrZEnqZY5VsjdU5WMnTmKY_5fCApIqBylMQlt9x2w51t6fgI3yiEJTpNQ4hiWAreZEDgKL4z0pN89WnAMsHK04K_ingFEIpyVBIMV_hNBInc698BPkMaED64L6qIxPeuHJbUoUpdC0gdA9kgaZWjgzYWLogkNsDL6TJV4gBL2SH0oj6kWNGUOQpf0ZZbo8_RdkgohOxRXJTTi5LXhvC6oCrJNYB2xKbd09bdh3gSoD--quQoguy0kRpSV3lY6t2arlly2T_cM0kNLyhqZk3qvIHxSFKQxRZ6-kypThNpwLED9QmDiZiBdripEMibyY7QwDv3uE0TzAD36bp-_fNxfl0MVk2vxovF-P57cz8-q-30-vlP-bT6-bXow8joLAY6fDGDaERWkEoSigEX55QkHatNO5UZ5sJkAHEb2iUTBY6dAeTUsMezAehaad16tqygggflebQtwVS8RX31LWrhsH4SOwzhkqGHxDHbTmijah5wswU4yunn7zy-8krh58U36O2dX8zSX3fXVQqSpvS-t8U44xUIhh-k6NkcP4mRzn6iP_LWSrQlXkNfZNDZYJ6-aMqs2xOjCajZdCHipUDpeff05Ag69AoQrQ9MhKV8cbi_KKHSXGYQQAbyyfICK1ZB8kIisknEU8fqN6GWBxI8Scua561yXkoBisM-gHZTB6UcAMJzR-kOhAX62sx6DDQR1bOvRFUKTRtTHBIdBjU1ZnZriGhJPKpGuXoO2S1V51sjG6a22U3UW2v513Vsxi2mNtjYUrsGqU_AuLPJIZQDAVW2dsV5f-sprbDwHFED4KitFcSeNo_TLLpA0I3CFjOmkInVy6AvPeayiJPa1kMHCgSGup-Y1AgZWvyBuretsRD-BVONox6CLgyg7yh3A4lbzIW9PuNjeLa1l03Wq_U2NKaGHAwqgjXG5A8Apotcc2qMgwhQiFmbsePcoLgOYEj4pOeU28tbuU2jYpP7KCzlN-DsTExXmuTSekDFSvyE8R5si0-H3QZcdiMkUNdAGZSVqyx3dwgeCibb4pEGWDZYO9tasG7bJeoYkdfH4QReHY7fWNSVAUaWT0cBrahkyf-FEOjOoDs39tJLPqkoENM1uAecyXRQad-rOg4velAzX7KoSBmSRnfir1PXRPkzfT6b7PxNOhf4y0IDNqKBd4-_zt0vF3hmD2QELeT5V9QQu4h-YAr37Qx-nhIsJVXj-bwpTb2uHo0MFVsDtWDsa7ZKq4evcMofQY1ISI4kQdM-N63E6Xfyf_b7zvAMWr0Pu9wzFFJvW3WdJRWXIxEtKzLqA2E0zz7WiqGY5WzDiNB2x2L4YQ-YDZBzV12_9MxX-F8dAPGLqsGSE-7GGct_60mlLatqmj4w8VCXQUUdlhmevHvgTWLL6gEdk9HtvxY07AnSUlQvmdyJMyahD252ZLohH7tLhSDkFUm1aoQ22YxBWhm1MbynG6hqmszs8tjXpYoTtrTAraHoD80jpeL9fVyPp9eB4W1FGOT4If1emUNjRBCMkbjGGzqsyOHj62QIiBZ4qeKtS3jkO4JzJC0LyjiRxBB9nhgs9Eyw3lwMqV0AD6UfucDNSpzH9DsAOxQV2n-EpKUV5XN_V5BKmd3o5rOvldCqsLeD2wU1R60taj23VcPCh6cHgV86tTc3n9sw307a11lg5fTu--SRubuZMVV0vYx38zQnQir-tar-SLrumXprTI9Eq2q0Fg9WCOH_1wztl5P56PxbLkYXU0X6-WNDKQV4gewofT5VxT09WG3olpPtd_9MhgYA9phMBPFQPHzEgNerL_7RQR2c1A5FCdGHTaoaWNnvBoZdsaXhWHnDa3hXeedagJX4Svhi3KKcvL86_M_aTE0U695n3-D3CaWMhrsKBsMBkohNeR7OKAxWWouFdKwLbS6puZy4w26QbL1xkrjZIJ3OI3kvI8Xr0pQgkBGfc3Yc44CFScUO-0kfXT03tLYKBEbaciHbQcvH7piY_oY4kIbw5aritsLz4wIgwI46N8QYf1lQW6ixWnzyof3i6mMn-qUkqwlwgrKt0Yz54DNjX7OARs3mjoHaKr1dfvZESwIXpJ6pIuDK_E7wZIzrTUdDN7XsCGsIE3fPoDWurogWmfqpFLGXBegYvcaFM9S8GQMi7RguOCpfAFv8NRwzwYzmncaF2y5p8Fjwz-NNcv83sJh8cFgTLc-8x2nxR6oHg2CYdG3IfP9aIu4KOoCZeHrJa8MwnmMuG0dgoaBeFfvBVveqXfYVb7q0DTuQJbTh_1IffKg0HWMkS-1Icz8p_xdiw4XztYcqQ2DFeU8J2oE0DvsbRmJesOM5fiwB7QSJD72imLirpd9hJx81xvCY4TvUR5nd7279Ats26H075Qm5U5G8-3H3vAexRw-5bsIgR3KnwJXEPH7GzameZr1hq_PLgsaveHn3mNveHoxOHlz8fby9Pzk-Pzs8s2bw97PALp4Ozh7c3p6efr65Pzs4vTsy2HvU3Ho8eDi9cXx8enx5cn5ydnb87dvvvwXOFOIjQ)

![uml.png](uml.png)

## Identificação
**Nome:** Josias Augusto Kautzmann

**Curso:** Sistemas de Informação

**Disciplina:** Paradigmas de Programação

---

## Proposta
O **Literato** é um sistema de backend desenvolvido em Java para gamificar o hábito da leitura. O objetivo é permitir que usuários registrem seu progresso de leitura, mantenham uma sequência de dias lendo (streak) e desbloqueiem conquistas baseadas em seu desempenho.

---

## Arquitetura e Estrutura do Código

O projeto segue uma arquitetura em camadas (Layered Architecture), fundamental para organizar um sistema robusto e escalável. Cada parte do código tem uma responsabilidade única (**Single Responsibility Principle**).

### 1. Model (`io.literato.model`)
Esta camada representa os objetos do mundo real e as entidades do sistema. Aqui tem aplicação de **Encapsulamento**.
*   **O que é:** Classes POJO (Plain Old Java Objects) que carregam dados.
*   **No Projeto:**
    *   `Usuario.java`: Guarda estado (pontos, streak, bio).
    *   `Clube.java`: Representa grupos de leitura.
    *   **Polimorfismo:** No pacote `conquista`, temos uma classe base abstrata `ConquistaBase` e várias implementações (`ConquistaPaginas`, `ConquistaStreak`). Isso permite que o sistema trate qualquer tipo de conquista da mesma forma, facilitando a criação de novas regras sem alterar o código principal.

### 2. DAO - Data Access Object (`io.literato.dao`)
Esta camada é responsável pela **Persistência**. O restante do sistema não sabe se estamos usando SQLite, MySQL ou um arquivo de texto; ele apenas pede dados ao DAO.
*   **O que é:** Classes que executam comandos SQL (INSERT, SELECT, UPDATE, DELETE).
*   **No Projeto:**
    *   `Database.java`: Gerencia a conexão (Singleton/Static factory) e inicializa as tabelas.
    *   `UsuarioDAO.java`, `ClubeDAO.java`: Traduzem objetos Java para linhas no banco de dados e vice-versa.
    *   **Segurança:** Uso de `PreparedStatement` para prevenir injeção de SQL.

### 3. Service (`io.literato.service`)
É o "cérebro" da aplicação. Aqui reside toda a **Regra de Negócio**.
*   **O que é:** A camada que orquestra as operações. Ela não lida com HTTP (Controller) nem com SQL (DAO), apenas com lógica.
*   **No Projeto:**
    *   `GamificacaoService.java`: É a classe mais importante.
        *   Quando um usuário registra leitura, o Service: 1) Salva o progresso; 2) Calcula novos pontos; 3) Verifica se o streak (dias seguidos) aumentou; 4) Varre todas as conquistas para ver se o usuário desbloqueou alguma nova.
    *   **Injeção de Dependência:** O Service recebe os DAOs no seu construtor, permitindo baixo acoplamento.

### 4. Controller (`io.literato.controller`)
É a porta de entrada da API. Responsável por receber as requisições HTTP e devolver as respostas JSON.
*   **O que é:** A camada que "fala" a língua da Web (GET, POST, PUT, DELETE).
*   **No Projeto:**
    *   `LeituraController.java`: Recebe o pedido de "registrar leitura", extrai os dados do JSON, chama o `GamificacaoService` e devolve `200 OK` ou `400 Bad Request`.
    *   `ClubeController.java`: Gerencia rotas de criação e entrada em clubes.
    *   Uso do framework **Javalin** para mapear rotas de forma simples e leve.

### 5. Frontend (`src/main/resources/public`)
A interface visual onde o usuário interage.
*   **Tecnologia:** Vue.js (Composition API) + Bootstrap 5.
*   **Estrutura:**
    *   `app.js`: Ponto de entrada, gerencia o estado global (usuário logado).
    *   `modules/`: Componentes separados (`reading.js` para estante, `clubs.js` para grupos).
    *   `config.js`: Arquivo inteligente que detecta se o código está rodando no PC do desenvolvedor ou no servidor de produção, ajustando as URLs da API automaticamente.

---

## Processo de Desenvolvimento

O desenvolvimento do projeto foi dividido em etapas incrementais, focando primeiro na lógica de negócios (Backend) e posteriormente na interface (Frontend) e implantação.

### 1. Modelagem e Arquitetura (POO)
O primeiro passo foi definir as entidades do domínio (`Usuario`, `Livro`, `Clube`, `ItemEstante`). Utilizei conceitos de **Orientação a Objetos** para criar uma arquitetura robusta:
*   **Encapsulamento:** Proteção dos dados sensíveis dos modelos.
*   **Herança e Polimorfismo:** Criação de um sistema de conquistas extensível (`ConquistaBase` herdada por `ConquistaPaginas`, `ConquistaStreak`, etc.), permitindo tratar diferentes regras de gamificação de forma genérica.

### 2. Implementação do Backend (Java + Javalin)
API RESTful utilizando **Javalin**. A estrutura foi separada em camadas:
*   **Controller:** Gerencia as requisições HTTP.
*   **Service:** Contém a regra de negócio (cálculo de pontos, verificação de streak).
*   **DAO (Data Access Object):** Abstrai a comunicação com o banco de dados.

### 3. Persistência de Dados
Foi integrado o banco de dados **SQLite** para armazenar usuários, clubes e progresso. Implementada a leitura de um arquivo CSV (`books.csv`) contendo milhares de livros para popular o banco inicial, utilizando `Resources` do Java para garantir compatibilidade no Docker.

### 4. Frontend (Vue.js)
Foi criada uma interface reativa utilizando **Vue.js 3** (Composition API simplificada). O frontend consome a API Java e gerencia o estado da sessão do usuário, permitindo interações dinâmicas sem recarregar a página (SPA - Single Page Application).

### 5. Implantação (DevOps)
Foi configurada o ambiente de produção:
*   **Render:** Hospedagem do Backend.
*   **Itch.io:** Hospedagem do Frontend.

---

## Dificuldades e Soluções

Durante o desenvolvimento, enfrentei desafios técnicos que exigiram soluções criativas:

### 1. Configuração de CORS (Cross-Origin Resource Sharing)
*   **Dificuldade:** Como optei por uma **arquitetura desacoplada** (Frontend separado do Backend), enfreitei o bloqueio de segurança dos navegadores (Same-Origin Policy). O navegador impedia que o site (hospedado no Itch.io ou rodando na porta 5500) acessasse a API (hospedada no Render ou porta 7070) por serem de origens diferentes.
*   **Solução:** Implementação de um `CorsPlugin` no Javalin (`Main.java`) configurado para permitir requisições de qualquer origem (`anyHost`), liberando os cabeçalhos HTTP necessários (`Access-Control-Allow-Origin`) para autorizar a comunicação entre os dois servidores distintos.

### 2. Lógica de Ranking Temporal (SQL Complexo)
*   **Dificuldade:** Criar um ranking que filtrasse por períodos (Dia, Semana, Mês) sem excluir usuários que não leram nada (que deveriam aparecer com 0 pontos) e sem misturar pontos de períodos diferentes. O desafio era combinar junções de tabelas (`JOIN`) com agregações (`SUM`) e filtros de data dinâmicos.
*   **Solução:** No `UsuarioDAO`, implementei uma query SQL dinâmica com `StringBuilder`. Utilizei `LEFT JOIN` entre usuários e leituras para garantir que todos os usuários sejam listados. A filtragem de datas é feita calculando o período exato no Java (`LocalDate.now().minusDays(7)`) e passando como parâmetro para a cláusula `WHERE`, garantindo precisão e segurança contra SQL Injection.


---

## Pré-requisitos
Java 17 ou superior
Maven
(Opcional) VS Code com extensão "Dev Containers" para ambiente automático.
## Instalação e Execução
Clone o repositório.
Na raiz do projeto, compile o código: mvn clean compile
Execute a aplicação: mvn exec:java -Dexec.mainClass="io.literato.Main"
O servidor iniciará na porta 7070.

## Referências e Créditos

*   **Arquitetura e Padrões:**
    *   [Layered Architecture](https://dev.to/yasmine_ddec94f4d4/understanding-the-layered-architecture-pattern-a-comprehensive-guide-1e2j)
    *   [Data Transfer Object (DTO)](https://martinfowler.com/eaaCatalog/dataTransferObject.html)
    *   [Template Method Pattern](https://refactoring.guru/design-patterns/template-method) (Utilizado no sistema de Conquistas)

*   **Tecnologias Backend:**
    *   [Javalin Documentation](https://javalin.io/documentation)
    *   [SQLite JDBC](https://github.com/xerial/sqlite-jdbc)
    *   [Apache Maven](https://maven.apache.org/)

*   **Tecnologias Frontend:**
    *   [Vue.js 3 Guide](https://vuejs.org/guide/introduction.html)
    *   [Bootstrap 5](https://getbootstrap.com/)

*   **Ferramentas:**
    *   [Mermaid.js](https://mermaid.js.org/) (Diagramas UML)
    *   Assistência Técnica: GitHub Copilot (Apoio na geração de boilerplate e configuração do Maven).